<app-side-nav>
  <div class="account-page">
    <div class="account-card">
      <header class="account-header">
        <div>
          <h2 class="account-title">Mon profil</h2>
          <p class="account-subtitle">
            Gérez vos informations et préférences My Shop.
          </p>
        </div>
      </header>

      <div class="profile-body">
        <div *ngIf="(loading$ | async)" class="loading-zone">
          <mat-spinner diameter="40"></mat-spinner>
        </div>

        <p *ngIf="(error$ | async) as error" class="error-text">
          {{ error }}
        </p>

        <ng-container *ngIf="(profile$ | async) as profile">
          <div class="profile-grid" [class.profile-grid--single]="!(loading$ | async)">
            <section class="profile-section">
              <h3 class="section-title">Informations de compte</h3>

              <div class="field-group">
                <span class="field-label">Identifiant</span>
                <p class="field-readonly">{{ profile.username }}</p>
              </div>

              <div class="field-group">
                <span class="field-label">Email</span>
                <p class="field-readonly">{{ profile.email }}</p>
              </div>

              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Nom complet</mat-label>
                <input matInput formControlName="fullName" />
              </mat-form-field>
            </section>

            <section class="profile-section">
              <h3 class="section-title">Préférences</h3>

              <mat-slide-toggle formControlName="newsletter">
                Recevoir la newsletter
              </mat-slide-toggle>

              <mat-form-field appearance="outline" class="full-width rating-field">
                <mat-label>Note minimale par défaut</mat-label>
                <input
                  matInput
                  type="number"
                  min="0"
                  max="5"
                  step="0.5"
                  formControlName="defaultMinRating"
                />
              </mat-form-field>

              <p class="hint">
                Cette note sera utilisée comme filtre minimum sur la page produits.
              </p>
            </section>
          </div>

          <div class="actions">
            <button
              mat-raised-button
              color="primary"
              class="primary-cta"
              type="button"
              (click)="save()"
            >
              Enregistrer les préférences
            </button>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</app-side-nav>